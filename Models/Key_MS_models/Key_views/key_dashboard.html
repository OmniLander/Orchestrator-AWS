<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Key Pair Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { padding: 20px; }
        .section { margin-bottom: 40px; }
        #keysList { white-space: pre-wrap; }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="mb-4">AWS Key Pair Management Dashboard</h1>
        
        <!-- Section to List Existing Keys -->
        <div class="section">
            <h2>List Existing Keys</h2>
            <button id="listKeysBtn" class="btn btn-primary">Load Keys</button>
            <pre id="keysList" class="mt-3 bg-light p-3 border"></pre>
        </div>
        
        <!-- Section to Create Key -->
        <div class="section">
            <h2>Create New Key Pair</h2>
            <form id="createKeyForm">
                <div class="mb-3">
                    <label for="keyName" class="form-label">Key Name</label>
                    <input type="text" class="form-control" id="keyName" required>
                </div>
                <div class="mb-3">
                    <label for="keyFormat" class="form-label">Key Format</label>
                    <select class="form-select" id="keyFormat">
                        <option value="pem">PEM</option>
                        <option value="ppk">PPK</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-success">Create Key</button>
            </form>
            <pre id="createResponse" class="mt-3 bg-light p-3 border"></pre>
        </div>
        
        <!-- Section to Delete Key -->
        <div class="section">
            <h2>Delete Key Pair</h2>
            <form id="deleteKeyForm">
                <div class="mb-3">
                    <label for="keyId" class="form-label">Key Pair ID</label>
                    <input type="text" class="form-control" id="keyId" required>
                </div>
                <div class="mb-3">
                    <label for="keyNameDelete" class="form-label">Key Name</label>
                    <input type="text" class="form-control" id="keyNameDelete" required>
                </div>
                <button type="submit" class="btn btn-danger">Delete Key</button>
            </form>
            <pre id="deleteResponse" class="mt-3 bg-light p-3 border"></pre>
        </div>
    </div>

    <script>
        // List Keys
        document.getElementById('listKeysBtn').addEventListener('click', async () => {
            try {
                const response = await fetch('/Keys_in_existance');
                const data = await response.json();
                document.getElementById('keysList').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('keysList').textContent = 'Error: ' + error.message;
            }
        });

        // Create Key
        document.getElementById('createKeyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const keyName = document.getElementById('keyName').value;
            const keyFormat = document.getElementById('keyFormat').value;
            try {
                const response = await fetch('/Create_key', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key_name: keyName, key_format: keyFormat })
                });
                const data = await response.json();
                document.getElementById('createResponse').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('createResponse').textContent = 'Error: ' + error.message;
            }
        });

        // Delete Key
        document.getElementById('deleteKeyForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const keyId = document.getElementById('keyId').value;
            const keyName = document.getElementById('keyNameDelete').value;
            try {
                const response = await fetch('/Delete_key', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ key_id: keyId, key_name: keyName })
                });
                const data = await response.json();
                document.getElementById('deleteResponse').textContent = JSON.stringify(data, null, 2);
            } catch (error) {
                document.getElementById('deleteResponse').textContent = 'Error: ' + error.message;
            }
        });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>